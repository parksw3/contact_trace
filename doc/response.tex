\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}

\usepackage{color}

\usepackage{natbib}
\setcitestyle{numbers} 
\setcitestyle{square}
\bibliographystyle{prsb}

\usepackage{lmodern}
\usepackage{amssymb,amsmath}

\newcommand{\rR}{\mbox{$r$--$\cal R$}}
\newcommand{\RR}{\ensuremath{{\cal R}}}
\newcommand{\RRhat}{\ensuremath{{\hat \cal R}}}
\newcommand{\Rx}[1]{\ensuremath{{\cal R}_{#1}}} 
\newcommand{\Ro}{\Rx{0}}
\newcommand{\Reff}{\Rx{\mathit{eff}}}
\newcommand{\Tc}{\ensuremath{C}}

\newcommand{\Rini}{\Rx{\textrm{\tiny initial}}}

\newcommand{\reviewer}{\subsection*}
\newcommand{\revtext}{\textsf}
\newcommand{\newtext}[1]{\textsl{``#1''}}
\setlength{\parskip}{\baselineskip}
\setlength{\parindent}{0em}

\newcommand{\comment}[3]{\textcolor{#1}{\textbf{[#2: }\textsl{#3}\textbf{]}}}
\newcommand{\jd}[1]{\comment{cyan}{JD}{#1}}
\newcommand{\swp}[1]{\comment{magenta}{SWP}{#1}}
\newcommand{\dc}[1]{\comment{blue}{DC}{#1}}
\newcommand{\jsw}[1]{\comment{green}{JSW}{#1}}
\newcommand{\hotcomment}[1]{\comment{red}{HOT}{#1}}

\begin{document}

\noindent Dear Editor:

Thank you for the chance to revise and resubmit.
%% We apologize for the delay. (They don't care.)
Reviewer 1 suggested that we should divide the paper into two: theory and application.
Given the relevance of this manuscript to the current COVID-19 outbreak, we think it is best to write an application-based one first (this one) and then write a theory-based on later.
We believe that incorporating some theory with application will help readers understand the material better at the moment.
Otherwise, we have tried our best to incorporate the reviewers' suggestions.
See below for detailed response.

\reviewer{Reviewer \#1}

\revtext{The main objective of this paper is to correct selection bias in observational
(contact tracing) data to yield unbiased estimate of the "true" distribution
corresponding to generation intervals defined in Lines 42-43 (if I understand
properly).}

There are many ways to measure a generation interval. We are interested here in exploring these different definitions, and in finding how these definition affect the \rR\ link. We have tried to clarify this throughout the revised MS.

\revtext{Lines 42-43: "A generation interval is defined as the time between when a
person becomes infected and when that person infects another person."
(with reference [10]). Indeed, most of the cited literature in this paper
start with the definition exactly the same way. I feel that this definition
is imprecise and is not as obvious as it reads, especially in its relationship
with the intrinsic generation interval (Line 46) and its distribution (Lines
49,101). It is not proven that they are equivalent.}

We start with the standard conceptual definition. There is no way to define GI that is both general and precise. We develop the theme of different definitions of GI throught the paper.

We now discuss these issues. At this point we added text:

\newtext{At the individual level, a generation \emph{interval} is defined as the time between when a person becomes infected and when that person infects another person \citep{svensson2007note}.
While this definition is widely used in the literature, it is not connected directly to a population-level \emph{distribution}.}

\revtext{Line 46: "...intrinsic generation intervals..." This is not yet defined. Is it equivalent to the definition in Lines 42-43?}

\revtext{Line 46: "......intrinsic generation intervals measure the infectiousness of an
infected individual." This statement is vague. I will get back to this phrase
a few pages later in the discussion on "equilibrium distributions" and
suggest ways to make it more precise.}

We now define intrinsic generation interval properly:

\newtext{The \emph{intrinsic} generation-interval distributions describe the expected time distribution of infectious contacts made by a primary case.}

In Section 2, we also introduce the idea that the intrinsic distributions can be thought of as equilibrium distributions:

\newtext{$g(\tau)$ is the expected time distribution of infectious contacts made by a primary case (the intrinsic generation-interval distribution \citep{champredon2015intrinsic}).
If the proportion of susceptibles contacted is not changing (for example in a homogeneously mixed at the endemic equilibrium or when the number of cases is vanishingly small), $g(\tau)$ also describes the realized generaton interval.}

\revtext{Lines 49,101: "...the intrinsic generation interval distribution..." While the
interval itself is not defined in Line 46 (in my opinion), its distribution is
clarified in Line 101 in relation to equation (2) under homogeneous mixing.
I hereby pose the following questions:}

\revtext{
1. Although $g(\tau) > 0$ satisfies all the properties of a probability density
function (p.d.f.) of a non-negative continues random variable, does that
automatically correspond to a specific random variable relevant to any of
the observable (or conceptually observable) "generation intervals"?
}

\revtext{
2. Is it the p.d.f. corresponding to the definition in Lines 42-43? Proof?
}

Our new definition of the generation interval and explanation in S2 (just above) address these questions to some extent. We prefer not to go deeper into the mathematical details for this paper.

\revtext{
Lines 44-48: "... the observed generation-interval distribution can change...
...observed generation intervals refer to the time between actual infection
events." The actual infection events correspond to the exact moments of
passing the infection between a pair of infected-susceptible individuals.
Are they observable? In most cases, including contact tracing, observable
events are clinical (e.g. onset of symptoms). The relationship between
the interval defined by the time between actual infection events and the
interval defined by the time between clinical onsets is unclear. At least the
latter depends on the incubation period (of the infectee), in addition to the
latent period and the infectious period (of the infector). The incubation
period is defined as the time from infection to symptom onset, and is
different from the latent period such as in the SEIR model. This paper
does not make such distinction. It assumes that the time between actual
infection events "were observable" in a hypothetical way.
}

\revtext{
Suggestion: Re-phrase "observed generation intervals" or make some further
clarification on this. This is important because naive readers may tend
to take the face value and collect different kinds of observed data and
make inferences, such as that based on clinical events. This is potentially
misleading.
}

We appreciate this point. We now refer to them as \emph{realized} intervals.

\newtext{There are important distinctions to be made when defining generation-interval \emph{distributions} at the population-level: \emph{intrinsic} generation-interval distributions describe the expected time between infection of a primary case and infection of its secondary cases in a fully susceptible population,
while \emph{realized} generation-interval distributions describe the time between actual infection events over the course of an epidemic.
Due to individual variation in infection time, the realized generation-interval distribution (at the population-level) can change depending on when and how it is defined \citep{svensson2007note, kenah2008generation, nishiura2010time, champredon2015intrinsic}.}

We have also added the following sentence as per suggestions in previous comments:

\newtext{While realized generation intervals often cannot be observed in practice (because it is not possible to observe the exact moment at which individuals become infected), the aggregated distribution is analogous to data collected through contact tracing during an ongoing epidemic:
we typically want to try to make inference based on all available data.}

\revtext{Lines 54-55: ``the backward generation interval...'' This is a key measurement in this paper along with the length-bias in relation to data observation scheme. Conceptually, there may also be a "forward" generation
interval. Both concepts were initially raised in Svensson (2007, ref.[21]
in the paper), who pointed out the difference in distribution between the
primary generation time as measured prospectively from the time of the
infection of the infector to the transmission to the infectee, and the secondary generation time as measured retrospectively from the time of the
transmission to the infectee to the infection of the infector.}

We now introduce the forward distribution as well.

\revtext{1. does that mean that your objective is to make unbiased inference on the
"forward", or the primary, generation time?}

Yes, we want to make inference on the \emph{initial} forward generation-interval distribution, rather than the intrinsic generation-interval distribution.
This is the distribution that correctly links the initial values of $r$ and \Reff.
We have tried to make this clear and no longer use the term ``effective'' generation-interval distribution.

\jd{I liked effective, meaning that one that links correctly. I think it's still in the abstract.}

\revtext{2. does the definition in Lines 42-43 correspond to the forward generation
interval?}

No. Lines 42-43 is simply a single measurement and does not correspond to any specific generation interval.

\revtext{3. does the definition in Lines 42-43 correspond to the intrinsic generation
interval (Line 46)?}

No. See above.

\revtext{4. does the definition in Lines 42-43 correspond to a random variable with
p.d.f. given by $g(\tau)$?}

No. See above.

\revtext{5. do you imply that the intrinsic generation interval (not defined in Line 46
but distributed according to Line 101) and the forward measure, and the
objective of the unbiased inference, are all equivalent?}

No. The intrinsic distributions does not account for any spatial effect and therefore are different from the forward distributions.
We have tried to make this clear throughout the manuscript.
In particular, we provide the following sentence in Introduction to distinguish intrinsic from the realized distributions:

\newtext{Since not all infectious contacts result in infection, realized distributions differ from the intrinsic distribution.}

\revtext{
The "the backward generation interval (or the secondary generation time)" is statistically sound. An infectee, before being infected, has been exposed to many infectors in a prevalent cohort and
could be independently infected by any of them. Each infectee is only associated with a single backward generation time whose distribution arises
from an independent competing risk framework. At the population level,
all backward measured intervals are independent random variables (but
not necessarily identically distributed). On the other hand, the "forward
generation interval" is problematic. A typical infected individual may
infect several contacts, but not independently if the infectious period is
random. Therefore, it is not appropriate to consider that the times to
transmission of the pathogen to its infectees as an iid. sample. This can
be shown in Exercise 3.5 (f) of Yan and Chowell (2019). At the population level, should such data can be observed, there might exist correlated
intervals arising from the same infector, something to ponder about.
}

We appreciate this point and have tried not to imply strong assumptions, and also taken care to empirically validate our statistical approaches.


\revtext{This paper addresses length-bias in the "backward generation interval" and
different ways of adjusting this bias, assuming the intervals were observable
especially in the contact tracing setting. This is scientifically important, not
only under the context of the current paper, but also applicable in many other
contexts in science. Several issues need to be discussed.}

Thank you. We have tried to address the issues outlined in the review.

\revtext{
Line 43: "...individual variation in infection time..." I presume the authors
meant individuals infected at different (calendar) times in the course of
an outbreak. If this is the case, I suggest re-wording to avoid confusion
}

We have removed this sentence.

\revtext{
Lines 59, 114-115, 129, etc.: There is a distinction between "truncation"
and "censoring" in survival analysis. In the current context (e.g. contact tracing), when the inclusion criteria is conditioning on the infection
event of the infectee and looking backward to ascertain the infection time
of its infector, it is right-truncation. It leads to over-sampling short durations (as stated in Line 129). I suggest to use "right-truncation" instead
of "censoring" throughout the paper, wherever it appears.
}

Done.

\revtext{
Lines 121 and 123: The backward generation-interval distribution $b_t(\tau)$ and
the "censored" (right-truncated?) generation-interval distribution $c_t(\tau)$
should be clearly defined and expressed (e.g. in terms of conditional distribution) before expressing the relationship (6).
}

We now define both backward and forward generation-interval distributions more appropriately in the text.
We now refer to $c$ as the ``aggregated'' generation-interval distribution (all realized generation intervals until certain time point).

\revtext{
Lines 233-241: Once more, the sampling bias corresponds to right-truncation,
not censoring. A great deal of words is involved leading to gef $g_{eff}(\tau)$. The
mathematical language is more powerful and perhaps gef $g_{eff}(\tau)$ could be
explained more concisely (and take less space?)
}

We have shortened and tried to improve this explanation. 

\revtext{Lines 241-243: "In a large homogeneously mixing population, the effective
distribution is expected to be equivalent to the intrinsic distribution..."
Define both $g(\tau)$ and gef $g_{eff}(\tau)$ mathematically at the first place and prove
their equivalence in a large homogeneously mixing population.}

We now show that the initial forward generation-interval distribution is equivalent to the intrinsic distribution.
We also point to the analytical intractability of the spatial effects on the realized generation-interval distributions (and therefore the initial forward distribution):

\newtext{Since spatial effects on realized generation intervals are generally expected to be analytically intractable, even in simple networks (e.g., see \cite{tomba2010some} for discussion regarding the realized generation intervals in a household with one infector and two susceptibles), we rely on simulations hereafter to vadliate our prediction.}

\revtext{However, I suggest the authors to compare the "individual-based
method" in the paragraph starting from Line 252 to Line 260 with the statistical methods for analyzing right-truncated survival data as mentioned
above, and explicitly write out the likelihood function (Line 258) to see if
they are the same or different.}

The likelihood function is provided in the Methods section.
\swp{TODO. It seems like they're different... Ugh. I'll get back to this.}

\revtext{The authors has used the notations $\RR$ (Line 35) and $\Ro$ (Lines 98-99) for reproduction numbers and
linked them via $\RR = \Ro S(t)$:}

\revtext{Shouldn't $\RR$ be a function of time $t$ via $S(t)$?}

We no longer use $\RR$ to avoid confusion. We now use $\Rini = \Ro S(0)$ to convey the idea that we consider the possibility that $S(0)$ may not be 1 but are not explicitly considering how $S$ changes through time.

\revtext{Is $S(t)$ a number or a proportion? In deterministic models, this matters
less as one can argue that all deterministic models are describing the
change of proportions (by re-scaling on population size, assuming it is
constant); but it matters a lot in stochastic models because the population
size is an essential parameter.}

We have tried to clarify these points. $S$ is a proportion, but we do attempt to address issues of individuality appropriately.

\jd{Is the reviewer getting paid by the word, or what?}

\revtext{
When stating that ``$\RR$'' transcends to the final size of the epidemic (Line
37), do the authors actually mean $\Ro$; which does not depend on time?
}

Yes. We now make a clear distinction between $\RR$ and $\Ro$.

\revtext{
When talking about the final size, one considers that the system is at a
disease-free equilibrium. When using the final size equation to calculate a
value for the reproduction number, the calculated value does not depend
on time. If there are behavior changes and public health interventions
throughout the outbreak, the calculated value $\RR_{final}$ is usually smaller
than $\Ro$ (defined at another disease-free equilibrium at the very moment
when an infector was seeded). So now we have three reproduction numbers, $\Ro$, a time-dependent $\RR = \Ro S(t)$ and $\RR_{final}$: Need to clarify the differences and reveal the hidden assumptions when discussing (and using)
each of them.
}

\swp{TODO? Just say we are interesting in the initial phase? maybe write something in the discussion? We're only using $\Rini$}

\revtext{
The authors stated that $\RR$ transcends to the final size of the epidemic
(with cited references). I boldly assume that the authors actually meant
by $\Ro$: This statement is in the context of a large outbreak that ends
when either there is no infectious individuals or there is no susceptible
individuals left in the population. Under a different context, the outbreak
may reach an endemic steady state with sustained on-going transmission
persisting for a very long period of time due to re-infection or demography.
It could be further said that $\Ro$ can transcend to the long term endemicity
level, such as $S(\infty) = \RR$: I leave to the authors to search the literature
for the latter
}

Yes, we meant $\Ro$. We have now clarified this in the text.
We now mention in Introduction that $\Ro$ can also affect the endemicity level and added a few citations.

\revtext{$g(\tau)$ as a p.d.f. given by (2) and Line 101 is also an equilibrium
distribution.}

While we agree with the reviewer that the intrinsic generation-interval can be interpreted an equilibrium distribution, this only holds under homogeneous mixing assumption. 
As we show in this paper, when there is spatial structure, the realized generation-interval distributions differ from the intrinsic one. 
Even when the entire population is susceptible, the forward generation-interval distribution of the single primary infector will still be subject to the egocentric effect.
Therefore, the realized generation intervals of a single, primary infector in an otherwise susceptible population will not follow the intrinsic generation-interval distribution. We do mention in the manuscript that the intrinsic distribution can be interpreted as an equilibrium distribution but do not want to over-emphasize this perspective, since we're interested in realized distributions on a spatial network.
The reviewer also presented a series of formulas on the mean generation interval for special cases of the SEIR model; these are interesting, but not a direction that we want to go with this version of the paper.

\revtext{
Expression (13) is the convolution (the sum of) the exponentially
distributed latent period with mean $1/\sigma$ and another exponential distribution, with mean $1/(\gamma+\lambda)$; as written in Lines 188-189. It is also equivalent
to the homogeneous mixing situation, in which, individuals during their
infectious periods are isolated (with rate $\lambda$) so that the "effective" duration
of the infectious period is exponentially distributed with mean $1/(\gamma + \lambda)$:
Any comments from the authors on this coincidence?
}

We explain this in the main text:

\newtext{In this case, with fixed infectiousness during the infection period, the effect of accounting for pairwise contacts is the same as an increase in the recovery rate (by the amount of the per-pair contact rate $\lambda$). 
Infecting a susceptible contact is analogous to recovery because the contactee cannot be infected again --- the infector cannot no longer transmit infection even if they are infectious (effectively losing infectiousness).
Therefore, the resulting egocentric generation-interval distribution is equivalent to the intrinsic generation-interval distribution with mean latent period of $1/\sigma$ and mean infectious period of $1/(\gamma + \lambda)$.}

\revtext{Under suitable assumptions on homogeneous mixing, the intrinsic
generation interval distribution $g(\tau)$ measures the infectiousness within
an infected individual without involving another individual. (In SEIS,
SEIR, SEIRS settings, it is a function of the latent period distribution
and the infectious period distribution.)}

We now define the intrinsic generation-interval distribution as follows as we think it is more concrete; it is also easier to distinguish intrinsic vs. realized distributions under this definition:

\newtext{The \emph{intrinsic} generation-interval distributions describe the expected time distribution of infectious contacts made by a primary case.}

\revtext{The distribution $g(\tau)$ links the two intrinsic parameters R0 and r
(homogeneous mixing). Both $\Ro$ and $g(\tau)$ are intrinsic in the context of the equilibrium conditions. Therefore the parameter $r$ is a theoretical value and is very different from any observed exponential
or sub-exponential growth rate as the system is not at equilibrium.}

\revtext{Observed exponential or sub-exponential growth events are different from the infection events. The current paper only addresses the infection events (mostly unobservable). This was
already addressed in the comments with respect to Line 47-48.
Any attempt to link the estimated $r$ based on data collected
on observed events using the Euler-Lotka equation could be extremely misleading}

We have tried to clarify points related to this objection in the MS. 
Briefly, $r$ can be defined as the logarithmic rate of change in incidence $\dot i/i$. It changes through time, but we are interested in estimating the value near the beginning (after transients, but before appreciable depletion of susceptibles). To do this with (simulated or real) data, we use a method that estimates the initial value of $r$, while making a first-order correction for the fact that it might be changing.

``Ma, Junling, Jonathan Dushoff, Benjamin M. Bolker, and David JD Earn. "Estimating initial epidemic growth rates." Bulletin of mathematical biology 76, no. 1 (2014): 245-260.''

We do expect the initial $r$, $R$ and forward generation time to obey Euler-Lotka.

\revtext{
The intrinsic parameters R0 and r are parameters in branching
process, which is used to approximate the "initial phase" of the
outbreak and that approximation is poor. By the way, the condition in Lines 107-108 $S(t) = S$ is also inaccurate. The expected exponential growth is under the approximation $S(t)/n \approx 1$ and
$n \to \infty$; where $n$ is the population size. The so-called initial
phase (when the depletion of the susceptible population is negligible) totally ignores the difference between the initial disease free equilibrium and the highly explosive dynamic growth
}

The reviewer is apparently conflating the general case, which would in fact be problematic, with the case we consider: where the \emph{initial} population is not fully susceptible. In the latter case, there is a period where incidence is low and the depletion of the susceptible population is negligible.
To avoid confusion, we now use the term ``initial reproduction number'': $\Rini = \Ro S(0)$.

\revtext{
 It is too strong a statement that "the Erlang distributions are
more realistic than the exponentially distributed periods in the standard
SEIR model." The advantage of using the Erlang distributions is that the
system can be analyzed using ordinary differential equations. They are
only suitable for latent and infectious periods with very small variances
The Erlang distribution is not only a subset of the gamma distribution with integer valued shape parameters, but also it is limited to distributions with variances smaller than the corresponding exponential distribution with the same mean value.
}

The exponential distribution is a special case of the Erlang distribution (when the shape parameter is equal to 1). So our statement is at least technically correct.
We agree that we should not over-emphasize the flexibility of the Erlang distribution.
We now say ``often'' more realistic.

\revtext{
One can not even claim the gamma distributions are more realistic
without supported by data. For one thing: all gamma distributions
have exponential tails which may be contested in real data.
}

\revtext{
"... based on more realistic distributions in Appendix." I do
not see "more realistic distributions" more than the Erlang distributions.
How about heavy tailed distributions and distributions with large variances? In fact, many of the discussions in this paper can be generalized
to arbitrarily distributed latent and infectious periods.
}

We had omitted a sentence previous --- we have now clarified this sentence as follows:

\newtext{In the main text, we present results based on exponentially distributed latent and infectious periods;
we show results based on more Erlang distributed latent periods ($n_E=2$), which better matches the incubation period distribution of Ebola virus disease, in Appendix.}

\revtext{
It is more convenient to use the Laplace transforms as a tool.
}

The reviewers discussion of and suggestions about Laplace transformations are interesting, but we think beyond the scope of this paper. Our experience has been that Laplace transformations and moment generating functions are as likely to obscure the key concepts underlying disease dynamics as to clarify them.

\jd{I would skip the following text.}

The SEIR model is just an example --- the purpose of this paper is not to go through all possible generalizations of the SEIR model, but rather to explore spatial effects.
The Laplace tranforms are only more useful for the intrinsic generation-interval distributions under the homogeneous assumption. 
The forward generation-interval distribution in a spatially hetergeneous environment is analytically intractable and therefore, the Laplace transforms no longer hold.
Given that our goal is to infer the initial forward generation-interval distribution, rather than the intrinsic distribution, we feel that the Laplace transforms are not necessarily helpful for the discussion.
In particular, the reviewer asks us to prove special cases of the Euler-Lotka equation, which has been proven previosuly as suggested by the references, using Laplace transforms; 
we do not think this is relevant to the discussion of our paper.

\revtext{How to assess if the gamma distribution is a good choice as a
model? Run some kind of goodness-of-fit tests?}

These are hard issues, but beyond the scope of this paper. Using exponentials is routine in many applications. Using gammas (or Erlangs) generalizes this, and is also commonly done. 
The gamma distribution has been previously tested for many diseases. 
In our case, Figure 4 demonstrates that the gamma approximation of the generation-interval distribution provides a reasonable estimate for the initial reproduction number from the exponential growth rate.
We now discuss additional evidence that gammas often provide reasonable estimates [our approximation framework] as well as cuss potential caveats in assuming a shape of the generation-interval distribution in Discussion.

\newtext{We compare two methods for estimating the initial forward generation-interval distribution and assume that the initial forward generation-interval distribution follows a gamma distribution.
The gamma approximation of the generation interval distribution has been widely used due to its simplicity;
we previously thought that summarizing the entire distribution with two moments (mean and variance) is sufficient to understand the role of generation-interval distributions in linking $r$ and $\Rini$.
However, further investigation of our methods suggests that making a wrong distributional assumption can lead to biased estimates of the mean and CV of a generation-interval distribution (Appendix A.3), even though the gamma distribution ``looks'' indistinguishable from the shape of the intrinsic generation-interval distribution (derived from the SEIR model).
These results are particularly alarming because it is impossible to know the true shape of the generation-interval distribution for real diseases.
Nonetheless, biases in the parameter estimates of a generation-interval distribution may cancel out and give unbiased estimate of the reproductive number (Appendix A.3).}

\jd{I am not sure what the last part could mean, except that some biases don't turn out as bad as others -- they can't cancel exactly, so we shouldn't say unbiased estimates... Am I missing something?}

\revtext{How does the likelihood
function look like? Since the "observed" generation-intervals (assuming
observable) do not arise from a designed random experiment, but observational data, I expect the likelihood function should reflect the observation
scheme (e.g. retrospective)? Please be explicit.
}

The population-level method does not take into account the observation scheme or the infection process. 
We simply fit the gamma distribution to all realized generation intervals (i.e., the aggregated distribution).
We have clarified the text: 

\newtext{The \textbf{population-level method} estimates the initial forward generation-interval distribution by reversing the inverse exponential weighting in the aggregated generation-interval distribution without explicitly accounting for the infection process (i.e., who infected whom):
\begin{equation}
f_0(\tau) \propto a_0(\tau) \exp(r\tau).
\end{equation}
In order to do so, we first approximate the aggregated distribution $a_0$ with a gamma distribution by assuming that aggregated realized generation intervals (subject to right-truncation) during the exponential growth phase come from the same gamma distribution;
specifically, we estimate the mean $\bar G$ and shape $\alpha$ of a by fitting a gamma distribution to the observed values by maximum likelihood.
The inferred initial forward generation-interval distribution also follows a gamma distribution with the same shape, but with mean $\alpha/(\alpha/\bar G - r)$.
We then use the estimated initial forward generation-interval distribution to infer the initial reproductive number $\Rini$ from the estimated growth rate (using the Euler-Lotka equation).}

\revtext{
Elaborate how the estimation of $\RR$ is expected to be sensitive to under-reporting (of which data)
}

That was a bad notation on our side --- we should not have used $\RR$ in the likelihood. 
We have changed the notation for the Poisson process and provide a better explanation.

\revtext{
How exactly is $\RR$ (and, is it \Ro or some kind of time-dependent \RR) estimated in this paper: via the Euler-Lotka equation or using the approach in White and Pagano (2007, ref. [54] in the paper)?
}

We estimate $\Rini$ via Euler-Lotka. We have tried to make this clear throughout the main text.

\revtext{
How close is the "related approach" in White and Pagano
(2007, ref. [54] in the paper) related to the current paper? Did they use the
Euler-Lotka equation at all? Did they define and measure the generation intervals that were consistent with the generation-intervals discussed in
the current paper?
}

\swp{TODO.}

\revtext{
The authors use a logistic function with a scale parameter $r$,
the carrier capacity parameter $K$ and the initial condition $c_0$ to model the
cumulative incidence $c(t)$: Assuming, (theoretically), the infection events
are observable. It is inaccurate to claim that r is the exponential growth
rate
}

\swp{TODO.}

\revtext{
The paper focuses on estimating the generating-interval distribution. There are
several generating-intervals and distributions mentioned in this paper, such as
$g(\tau)$; $b_t(\tau)$; $c_t(\tau)$; $g_eff(\tau)$; etc. To the end, it seems that the primary focus is the
intrinsic distribution $g(\tau)$; and relating this distribution with two other intrinsic
parameters: the reproduction number $\Ro$ and the Malthusian number $r$
}

The intrinsic distribution is not our primary focus. 
As we show in Figure 4, the intrinsic distribution overesitmates $\Rini$ as it does not account for spatial effects.
We tried to make clear that our goal is the initial forward distribution.

\revtext{
The authors have well demonstrated different sources of sampling bias
arising from contact tracing data, more noticeably, (i) length-bias due
to right-truncation because of retrospective measurement together with
different infection times during the course of the outbreak; (ii) due to the
network structure (e.g. the degree distribution and the degree excess (Line
408). Both sources, the right-truncation and the egocentric point of view
(Line 174), tend to give shorter on average observed intervals. These are
correct and important.
}

\revtext{
Any notion of bias is in the context against some "truth". The authors
proposed, and demonstrated by simulation, ways to adjust for the bias in
order to estimate this "truth". However, the authors equate the "true"
distribution to the intrinsic distribution $g(\tau)$ as if "obvious". It is not
obvious and this needs to be proven.
The intrinsic distribution $g(\tau)$ is an equilibrium distribution that
involves the equilibrium distribution of the infectious period (in SEIS,
SEIR, SEIRS settings). It is a renewal process concept and is only
valid when the system is under the equilibrium condition. It is not
obvious how it is related to measurements of "generation intervals"
when the system is not at equilibrium.
}

We now discuss this point in much more detail (and have discussed these points above). Briefly: we are interested in the initial forward distribution because this provides the \rR\ link. This approaches the intrinsic distribution in the case where mixing is homogeneous and the initial number infectious is small. We hope we have fixed all of the places where we failed to explain ourselves clearly.

\revtext{
 Under suitable assumptions on homogeneous mixing, the intrinsic
distribution $g(\tau)$ measures the infectiousness within an infected individual without involving another individual. It is not obvious how it
is related to measures involving two individuals, no matter whether
they are prospectively or retrospectively measured.
}

\revtext{
Potentially observable events do not take place at the exact moment
when transmission occurs.
}

This is an important concern, and we have discussed this issue a bit more. We note that this is not always the case: for example, transmission is one of the most observable features in rabies dynamics. In Ebola, dates of transmission are often estimated. We are currently working to extend our framework to cases that explicitly treat other events as the observables.

\revtext{
I rate this paper very high in scientific importance and in general interest.
In the last 20 years, especially since SARS outbreak in 2003, there has
been a huge volumn of related work, more than those referenced in this
paper. These "intervals" have been widely cited, measured and applied to
outbreak investigations, especially during the early stage. However, there
is a lot of ambiguity. There are occasions that the same terminology is
associated with two different definitions, whereas there are other occasions
that the same definition is assigned to different terminologies by different
researchers.
}

Thank you!

\revtext{
I suggest major revision of the paper and hope my comments are
constructive for the revision(s) for better clarification. It will be a
great contribution to this field.
}

We have made major revisions to the manuscript as per suggested comments.
We hope that our manuscript is clearer.

\revtext{
The immediate objective of this paper is to construct some "unbiased" estimate of the generation interval distribution (presumably, the intrinsic distribution $g(\tau)$). Its important goes beyond this immediate objective, that is, to attempt using quantities (assuming observable, at least conceptually) measured during a the very dynamic
phase of the system to make inferences on these intrinsic quantities
$\Ro$ and $r$: I feel the authors have fallen short of achieving these objectives. However, I would like to share some of my opinions and ideas
and hope that, after revision(s), some of these goals will be achieved.
}

\revtext{
I also recommend, for the authors to consider, breaking this paper
into two papers: one on mathematical theory and models to better
clarify concepts which I believe are still ambiguous in currently published literature; and another one on statistical models and methods
to link data to models.
}

See above for our discussion of these issues

\reviewer{Reviewer \#2}

\revtext{
This manuscript extends previous work to examine how observed generation intervals (estimated through contract tracing) are shaped by both temporal and spatial effects during the course of an epidemic and leverages this to construct two methods that correct for the time-censoring bias. These methods are then applied to simulated data with complete reporting and shown to accurately infer the reproductive number from the exponential growth rate.
}

\revtext{
The manuscript is well-written and presents novel methods to correct observed generation intervals to obtain estimates of R0. When reading sections 3 and 4, I was wondering if there was a conceptual diagram that would help the reader visualize the different spatio-temporal processes that impact the observed generation-interval distributions (summarized on lines 224-226).}

We have added a diagram to summarize these effects.

\revtext{Finally, while the methods are tested on simulated data with complete reporting, it's unclear how they would perform with incomplete reporting, and ultimately, with empirical data. Of course, the latter is beyond the scope of the current manuscript but it would be useful to include a straightforward treatment of simulated data with incomplete reporting to support the expectations discussed on lines 265-267.}

We have added a new figure to the supplementary figures to account for incomplete reporting.

\revtext{Minor points:}

\revtext{Figure 1: the average latent period is 11.4 days and the average infectious period is 5 days. However, these seem to be switched in Figures 2, 3 \& 4. Why?}

Thank you for pointing this out. We made typographical errors in figure captions. We have corrected this.

\revtext{Line 145: "acquantanceships" -> "acquaintanceships"}

Done.

\revtext{Figure 3 caption, last sentence: has recovered -> have recovered}

Done.

\revtext{Line 270: direction -> directions }

Done.

\bibliography{networkprsb}
\end{document}
