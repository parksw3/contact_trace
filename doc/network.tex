\documentclass[12pt]{article}
\usepackage[top=1in,left=1in, right = 1in, footskip=1in]{geometry}

\usepackage{graphicx}
%\usepackage{adjustbox}

\newcommand{\eref}[1]{Eq.~\ref{eq:#1}}
\newcommand{\fref}[1]{Fig.~\ref{fig:#1}}
\newcommand{\Fref}[1]{Fig.~\ref{fig:#1}}
\newcommand{\sref}[1]{Sec.~\ref{#1}}
\newcommand{\frange}[2]{Fig.~\ref{fig:#1}--\ref{fig:#2}}
\newcommand{\tref}[1]{Table~\ref{tab:#1}}
\newcommand{\tlab}[1]{\label{tab:#1}}
\newcommand{\seminar}{SE\mbox{$^m$}I\mbox{$^n$}R}

\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}

\usepackage{lineno}
\linenumbers

\usepackage[pdfencoding=auto, psdextra]{hyperref}

\usepackage{natbib}
\setcitestyle{numbers} 
\setcitestyle{square}
\bibliographystyle{prsb}
\date{\today}

\usepackage{xspace}
\newcommand*{\ie}{i.e.\@\xspace}

\usepackage{color}

\usepackage{xspace}

\newcommand{\Rx}[1]{\ensuremath{{\mathcal R}_{#1}}\xspace} 
\newcommand{\Ro}{\Rx{0}}
\newcommand{\RR}{\ensuremath{{\mathcal R}}}
\newcommand{\Rini}{\Rx{\textrm{\tiny initial}}}
\newcommand{\Rego}{\Rx{\textrm{\tiny egocentric}}}
\newcommand{\Rhat}{\ensuremath{{\hat\RR}}}
\newcommand{\tsub}[2]{#1_{{\textrm{\tiny #2}}}}

\newcommand{\comment}[3]{\textcolor{#1}{\textbf{[#2: }\textsl{#3}\textbf{]}}}
\newcommand{\jd}[1]{\comment{cyan}{JD}{#1}}
\newcommand{\dc}[1]{\comment{blue}{DC}{#1}}
\newcommand{\hotcomment}[1]{\comment{red}{HOT}{#1}}

%% \newcommand{\rev}[1]{\comment{red}{REV}{#1}}
\newcommand{\rev}[1]{}

\newcommand{\swp}[1]{\comment{magenta}{SWP}{#1}}
\newcommand{\new}[1]{\textcolor{blue}{#1}}

\newcommand{\jdnew}{\jd{NEW}}
\newcommand{\jddel}[1]{\jd{DELETE: #1}}

\begin{document}

\begin{flushleft}{
	\Large
	\textbf\newline{
		Inferring generation-interval distributions from contact-tracing data
	}
}
\newline
\\
Sang Woo Park\textsuperscript{1,2,*}
David Champredon\textsuperscript{3,4}
Jonathan Dushoff\textsuperscript{3,5,$\dagger$}
\\

\bigskip
\textbf{1} Department of Ecology and Evolutionary Biology, Princeton University, Princeton, New Jersey, USA
\\
\textbf{2} Department of Mathematics \& Statistics, McMaster University, Hamilton, Ontario, Canada
\\
\textbf{3} Department of Biology, McMaster University, Hamilton, Ontario, Canada
\\
\textbf{4} Department of Pathology and Laboratory Medicine, University of Western Ontario, London, Ontario, Canada
\\
\textbf{5} Michael G. DeGroote Institute for Infectious Disease Research, McMaster University, Hamilton, Ontario, Canada
\\
\bigskip

*swp2@princeton.edu\\
$\dagger$dushoff@mcmaster.ca
\end{flushleft} 

\section*{Abstract}

Generation intervals, defined as the time between when an individual is infected and when that individual infects another person, link two key quantities that describe an epidemic: the initial reproductive number, $\Rini$, and the initial rate of exponential growth, $r$.
Generation intervals can be measured through contact tracing by identifying who infected whom.
We study how realized intervals differ from ``intrinsic'' intervals that describe individual-level infectiousness, and identify both spatial and temporal effects, including truncating (due to observation time), and the effects of susceptible depletion at various spatial scales.
Early in an epidemic, we expect the variation in the realized generation intervals to be mainly driven by truncation and by the population structure near the source of disease spread; 
we predict that correcting realized intervals for the effect of temporal truncation but \emph{not} for spatial effects will provide the initial forward generation-interval distribution, which is spatially informed and correctly links $r$ and $\Rini$.
We develop and test statistical methods for temporal corrections of generation intervals,
and confirm our prediction using individual-based simulations on an empirical network.
\jd{I did not understand the therefore at all (and have deleted it).}

\section*{Keywords}

Infectious disease modeling, generation interval, basic reproductive number, population structure, contact tracing

\pagebreak

\section{Introduction}

An epidemic can be described by the exponential growth rate, $r$, and the reproductive number, \RR.
The reproductive number is defined as the average number of secondary cases arising from a primary case;
its value in a fully susceptible population, also known as the basic reproductive number \Ro, is of particular interest as it provides information about the final size of an epidemic \citep{anderson1991infectious, diekmann1990definition} as well as the endemicity level \citep{kribs2000simple, van2002reproduction, smith2012ross}.
However, estimating the reproductive number directly from disease life history requires detailed knowledge, which is not often available, particularly early in an outbreak \citep{dietz1993estimation}.
Instead, the reproductive number is often indirectly estimated from the exponential growth rate, which can be estimated from incidence data \citep{chowell2003sars, mills2004transmissibility, nishiura2009transmission, nishiura2010pros, ma2014estimating}.
These two quantities are linked by generation-interval distributions \citep{wearing2005appropriate, svensson2007note, roberts2007model, wallinga2007generation, park2019practical}.

At the individual level, a generation \emph{interval} is defined as the time between when a person becomes infected and when that person infects another person \citep{svensson2007note}.
While this definition is widely used in the literature, it is not connected directly to a population-level \emph{distribution}.
There are important distinctions to be made when defining generation-interval distributions at the population-level. The \emph{intrinsic} generation-interval distribution describes the expected time distribution of infectious contacts made by a primary case \citep{champredon2015intrinsic}.
On the other hand, \emph{realized} generation-interval distributions describe the time between actual infection events over the course of an epidemic.
Since some infectious contacts will be made with non-susceptible people, and thus not result in infection, realized distributions can differ systematically from the intrinsic distribution.

The shape of the realized generation-interval distribution depends on the reference time and perspective \citep{kenah2008generation, nishiura2010time, tomba2010some, champredon2015intrinsic, britton2019estimation}.
When an epidemic is growing exponentially, as often occurs near the beginning of an outbreak, the number of newly infected individuals will be large relative to the number infected earlier on. 
A susceptible individual is thus relatively more likely to be infected by a newly infected individual. 
Thus, ``backward'' generation intervals (which look at a cohort of infectees, and ask when their infectors were infected) will be shorter on average than intrinsic generation intervals -- the converse is true when an epidemic is subsiding \citep{nishiura2010time, champredon2015intrinsic, britton2019estimation}.
Likewise, we can define ``forward'' generation intervals, which look at a cohort of infectors and ask when their infectees were infected.
Mean forward generation intervals tend to decrease over the course of an epidemic due to susceptible depletion \citep{kenah2008generation, nishiura2010time, tomba2010some, champredon2015intrinsic}.

Realized generation intervals are also affected by spatial structure.
In a population that does not mix homogeneously, susceptibility will tend to decrease more quickly in the neighbourhood of infected individuals than in the general population.
This means that infectious contacts made late in an individual's infection are more likely to be ineffective due to contacts that were made earlier (because the contactee may have been infected already).
As a result, realized generation intervals (from the perspective of an infector) will typically have shorter mean than the intrinsic generation-interval distribution in a non-homogeneous population.
This perspective allows us to reinterpret the finding of \cite{trapman2016inferring} that, given an intrinsic generation interval and an observed growth rate, the reproductive number on various network structures is always smaller on a network than would be predicted from homogeneous mixing.

In practice, realized generation intervals are often difficult to measure for many diseases, because it is difficult to observe when individuals become infected;
in most cases, observable events are clinical (e.g. onset of symptoms).
There are some exceptions: for example, generation intervals are commonly measured directly through contact tracing for canine rabies, where infection events are bites \citep{hampson2009transmission}.
Intervals between observed disease progression events (commonly, onset of signs or symptoms) are called serial intervals.
Serial intervals are in many ways similar to generation intervals, but there are also complexities in their use.
We will not address these complexities here.

While an epidemic is ongoing, realized generation intervals can at least in theory can be measured by identifying who infected whom and when, and aggregated to form a single distribution.
We typically want to try to make inference based on this aggregated distribution -- that is, on all available data that have been gathered since the beginning of an epidemic.
These aggregated measurements are ``truncated'' because we do not know what happens after the time of last observaton.
The distribution of these truncated intervals are similar to backward intervals during the exponential growth phase: there is a bias towards over-sampling shorter intervals, which are more likely to have concluded in time to be observed.
We therefore predict that removing the truncation bias from aggregated generation intervals early in an epidemic will yield the initial forward generation-interval distribution, which contains information about the population structure and allows us to correctly infer the initial reproductive number from the initial exponential growth rate.

In this study, we explore spatiotemporal variation in realized generation intervals.
We extend previous frameworks to investigate how aggregated generation-interval distributions change over time.
We classify spatial effects on realized generation intervals into three levels (egocentric, local, and global) and discuss how these affect realized generation-interval distributions.
Finally, we compare two methods for accounting for temporal bias and test our prediction using individual-based simulations.

\jd{I don't love the prediction framework even after I toned it down: I feel we show that it should work in theory, not just predict that it should work in practice.}

\section{Intrinsic generation-interval distributions}

\begin{figure}[!ht]
\includegraphics[width=\textwidth]{../fig/individual_and_population.pdf}
\caption{\textbf{Comparison of individual- and population-level kernels.}
(Left) an individual-level kernel of an infected individual with latent period of 11.4 days followed by infectious period of 5 days;
this represents an individual realization of a random process.
(Right) a population-level kernel of infected individuals with latent and infectious periods exponentially distributed with means of 11.4 and 5 days, respectively;
this represents a population average of a random process.
Shaded areas under the curves are equal to individual- and population-level reproductive numbers, both of which are set to 2 in this example.
Parameters are chosen to reflect the West African Ebola outbreak \citep{who2014ebola}.}
\label{fig:indpop}
\end{figure}

Generation-interval distributions are often considered as population averages, but we can distinguish population-level distributions from individual-level distributions \citep{svensson2007note, svensson2015influence}; 
making this distinction clear will be particularly useful when we discuss spatial components later (see \fref{indpop}).
An individual-level intrinsic infection kernel $k(\tau; a)$ describes the rate at which an infected individual with ``aspect'' $a$ makes ``infectious contacts'' (contacts which will cause infection if the contactee is susceptible).
Individual aspects may represent variation in the course of infection (e.g., duration of latent and infectious periods) and the level of infectiousness, which can depend both on biological infectiousness as well as contact patterns.
Hereafter, we use $t, s$ to represent calendar time and $\tau$ to
represent time since infection.

Assuming that the individual properties are independent of risk of infection, the population-level kernel is given by integrating over these individual variations:
\begin{equation}
K(\tau) = \int k (\tau; a) f(a) \,\mathrm{d}a,
\end{equation}
where $f(a)$ represents a probability density over a (possibly multi-dimensional) aspect space.
The population-level kernel describes the rate at which infectious contacts are made by an an infected individual, on \emph{average}.

Assuming that a population mixes homogeneously, we can write: 
\begin{equation}
K(\tau) = \RR_0 g(\tau),
\end{equation}
where $\RR_0 = \int K(\tau)\,\mathrm{d}\tau$ is the basic reproductive number (the expected number of secondary cases caused by a randomly chosen infectious individual in a fully susceptible population \citep{anderson1991infectious}), 
and $g(\tau)$ is the expected time distribution of infectious contacts made by a primary case (the intrinsic generation-interval distribution \citep{champredon2015intrinsic}).
If the proportion of susceptibles contacted is not changing (for example in a homogeneously mixed population at the endemic equilibrium, or when the number of cases is vanishingly small), $g(\tau)$ also describes the realized generation intervals.

In a homogeneously mixing population, current disease incidence at time $t$, $i(t)$, is the product of the current infectiousness of individuals infected in the past and the current proportion of the population susceptible, $S(t)$.
\begin{equation}
i(t) = S(t) \int K(s) i(t-s)\,\mathrm{d}s = \RR_0 S(t) \int g(s) i(t-s)\,\mathrm{d}s.
\end{equation}
This model, referred to as the renewal equation, can describe a wide range of epidemic models \citep{heesterbeek1996concept, diekmann2000mathematical, roberts2004modelling, aldis2005integral, wallinga2007generation, roberts2007model, Champredon2018equivalence}.
Over a period of time where the susceptible proportion $S(t) = S(0)$ remains approximately constant, we would expect approximately exponential growth in incidence $i(t)$; assuming $i(t) = i(0) \exp(r t)$ yields the Euler-Lotka equation \citep{lotka1907relation}, which provides a direct link between the initial exponential growth rate $r$ and the initial reproductive number $\Rini = \Ro S(0)$:
\begin{equation}
\frac{1}{\Rini} = \int g(s) \exp(-r s)\,\mathrm{d}s.
\label{eq:euler}
\end{equation}
Under the homogeneous mixing assumption, the intrinsic generation-interval distribution $g(\tau)$ provides the correct link between $r$ and $\Rini$.

\section{Realized generation-interval distributions across time}

Realized generation intervals can be measured either forward (from the perspective of a cohort of infectors) or backward (from the perspective of a cohort of infectees) in time \citep{champredon2015intrinsic, britton2019estimation}.
The forward generation-interval distribution $f_t(\tau)$ describes the infection time of \emph{infectees} caused by a cohort infectors who were infected at time $t$.
Similarly, the backward generation-interval distribution $b_t(\tau)$ describes the infection time of \emph{infectors} for a cohort of infectees who were infected at time $t$.
For a single infector-infectee pair, both backward and forward \emph{measurements} should give the identical generation interval.
Therefore, the total number of infection that occurs at time $t + \tau$ caused by individuals infected at time $t$ can be expressed in terms of both the forward and backward generation-interval distributions:
\begin{equation}
i(t) f_t(\tau) = i(t+\tau) b_{t+\tau}(\tau).
\label{eq:equivalence}
\end{equation}

In a homogeneously mixing population, the forward and backward generation-interval distributions can be calculated exactly.
The density of new infections occurring at time $t+\tau$ caused by infectors who were infected at time $t$ is given by
\begin{equation}
i_{t}(t+\tau) = \RR_0 i(t) g(\tau) S(t+\tau)
\end{equation}
As shown in \cite{champredon2015intrinsic}, the forward generation-interval distribution, $f_t(\tau)$, is proportional to $i_{t+\tau}(t)$:
\begin{equation}
f_t(\tau) = \frac{g(\tau) S(t+\tau)}{\int_0^\infty g(\tau) S(t+\tau) \,\mathrm{d}\tau}.
\label{eq:forward}
\end{equation}
In this case, the initial forward generation-interval distribution $f_0(\tau)$ during the exponential growth phase (when $S(t) \approx S(0)$) is equivalent to the intrinsic generation-interval distribution $g(\tau)$ and, therefore, provides the correct link between $r$ and \Rini.
Likewise, the density of new infections occurring at time $t$ caused by infectors who were infected at time $t-\tau$ is given by
\begin{equation}
i_{t-\tau}(t) = \RR_0 i(t-\tau) g(\tau) S(t)
\end{equation}
The backward generation-interval distribution, $b_t(\tau)$, is proportional to $i_{t-\tau}(t)$:
\begin{equation}
b_t(\tau) = \frac{i(t-\tau) g(\tau)}{\int_0^\infty i(t-\tau) g(\tau)\,\mathrm{d}\tau}.
\end{equation}

\jd{Deleted ``epidemic time'' everywhere, it does not seem clear to me.}
During an ongoing epidemic, generation intervals cannot be measured for infection events that have not happened yet.
This effect is called ``right-truncation''.
Therefore, even if we aggregate all realized generation intervals by identifying who infected whom through contact tracing (assuming that infection events are observable), their mean will be shorter than the intrinsic generation intervals.
The aggregated generation-interval distribution, by definition, is a weighted average of backward generation-interval distributions (weighted by incidence) up until calendar time $t$:
\begin{equation}
a_t(\tau) \propto \int_{-\infty}^t b_s(\tau) i(s) \,\mathrm{d}s.
\end{equation}
The aggregated generation-interval distribution can be also equivalently expressed in terms of truncated forward generation-interval distributions:
\begin{equation}
a_t(\tau) \propto \int_{-\infty}^{t-\tau} f_s(\tau) i(s) \,\mathrm{d}s.
\end{equation}
\eref{equivalence} confirms that both expressions are identical.

For a single outbreak, the mean aggregated generation interval will always be shorter than the mean intrinsic generation interval (Figure~\ref{fig:censor}).
There are two reasons for this phenomenon.
First, longer generation intervals are more likely than short intervals to be missed due to right truncation.
In particular, if we assume that the initial forward generation-interval distribution remains constant ($f_t(\tau) \approx f_0(\tau)$) when an epidemic is growing exponentially ($i(t) = i(0) \exp(rt)$), 
the initial aggregated (or backward) generation-interval distribution is just the initial forward generation-interval distribution discounted by the rate of exponential growth \citep{britton2019estimation}:
\begin{equation}
a_0(\tau) = b_0(\tau) \propto f_0(\tau) \exp(-r\tau).
\label{eq:exp}
\end{equation}
A deterministic simulation confirms that the aggregated generation-interval distribution has the same mean as the backward generation-interval distribution during this period (Figure~\ref{fig:censor}).
Second, the decreasing number of susceptibles over the course of an epidemic makes long infectious contacts less likely to result in infection \citep{champredon2015intrinsic}.
Overall, we therefore expect naively using the aggregated generation-interval distribution to underestimate the initial reproductive number.

\begin{figure}[!ht]
\includegraphics[width=\textwidth]{../fig/temporal_effect.pdf}
\caption{\textbf{Temporal variation in the mean backward and aggregated generation interval.}
A deterministic Susceptible-Exposed-Infectious-Recovered (SEIR) model is simulated using Ebola-like parameters \citep{who2014ebola}: mean latent period $1/\sigma = 11.4 \textrm{ days}$, mean infectious period $1/\gamma = 5 \textrm{ days}$, and the basic reproductive number $\RR_0 = 2$. 
The mean backward and aggregated generation interval are calculated over the course of an epidemic.
The dotted horizontal line represents the mean intrinsic generation interval.
}
\label{fig:censor}
\end{figure}

\section{Realized generation-interval distributions across space}

\jd{How do you feel about rewriting this paragraph? It sounds like we introduce space to understand effects of multiple contacts; in fact, the opposite is true; we got into the effects of multiple contacts because we were interested in space.}
Infected individuals may contact the same susceptible individual multiple times, but only the first infectious contact gives rise to infection in a given individual (after this, they are no longer susceptible).
Therefore, we expect realized generation intervals from an individual to have a smaller mean than their mean intrinsic generation interval.
To explore the effect of multiple contacts on realized generation intervals, we relax our assumption that the population is homogeneous.
Instead, we assume that a disease spreads on a network;
infected individuals contact their ``acquaintances'' at random, but ``acquaintanceships'' are predetermined by the network structure before the beginning of an epidemic \cite{trapman2016inferring}.

We first consider the infection process from an ``egocentric'' point of view, taking into account infectious contacts made by a single infector.
We define the egocentric kernel as the rate at which secondary infections are realized by a single primary case with aspect $a$ in the absence of other infectors:
\begin{equation}
\hat{k}(\tau; a) = k(\tau; a) \exp \left(- \delta(a) \int_0^\tau k(s; a) \,\mathrm{d}s\right),
\end{equation}
where $k(\tau; a)$ is the individual-level intrinsic kernel and $e^{- \delta(a) \int_0^\tau k(s; a) ds}$ is the probability that a susceptible acquaintance has not yet been contacted by the focal individual.
The dilution term, $\delta(a)$, models how contacts are distributed among the acquaintances.

Throughout this paper, we assume that there is a constant per-pair contact rate $\lambda$ \cite{trapman2016inferring}.
In this case, the infectiousness of an individual $\RR(a) = \int k(s; a) \,\mathrm{d}s$ is the product of the number of acquaintances $N(a)$, which can vary among individuals, and the contact rate $\lambda$; the dilution term is equal to the reciprocal of the number of acquaintances: $\delta(a) = 1/N(a)$.
This assumption can be relaxed by allowing for asymmetry \citep{trapman2016inferring} or heterogeneity \citep{ball1997epidemics, ball2002general} in contact rates; 
for simplicity, we do not pursue these directions here.

The population-level egocentric kernel is found by integrating the individual-level kernel over individual variations:
\begin{equation}\label{eq:ego}
\hat{K}(\tau) = \int \hat{k}(\tau; a) f(a) \,\mathrm{d}a,
\end{equation}
where $f(a)$ represents a probability density over a (possibly multi-dimensional) aspect space.
Essentially, the population-level egocentric kernel accounts for the probability that a susceptible individual has not been infected by the focal individual.
Trapman \textit{et al.} \cite{trapman2016inferring} used this same kernel (also assuming a constant per-pair contact rate) to study the effect of network structure on the estimate of reproductive number.
The population-level egocentric generation-interval distribution is:
\begin{equation}
\hat{g}(\tau) = \frac{\hat{K}(\tau)}{\int \hat{K}(s)\,\mathrm{d}s}.
\label{eq:conditional}
\end{equation}
The population-level egocentric generation-interval distribution describes the distribution of times at which secondary infections are realized from an \emph{average} infected-susceptible pair; for convenience, we will often omit ``population-level''.
Finally, the initial exponential growth rate and the egocentric reproductive number are linked by the egocentric generation-interval distribution (and the Euler-Lotka equation) \citep{trapman2016inferring}:
\begin{equation}
\frac{1}{\Rego} = \int \hat{g}(\tau) \exp(-r \tau)\,\mathrm{d}\tau.
\label{eq:egorR}
\end{equation}
As the egocentric distribution always has a shorter mean than the intrinsic distribution, $\Rego$ will be smaller than $\Rini$ estimated from the intrinsic distribution;
this generation-interval-based argument provides an alternative biological interpretation for the result presented by \cite{trapman2016inferring}.
% Similarly, \Rhat\ will be greater than the \emph{true} reproductive number \RR\, since it does not account for depletion of susceptibles by other routes.

For example, consider a susceptible-exposed-infected-recovered (SEIR) model, which assumes that latent and infectious periods are exponentially distributed.
The intrinsic generation-interval distribution that corresponds to this model can be written as \citep{Champredon2018equivalence}:
\begin{equation}
g(\tau) = \frac{\sigma \gamma}{\sigma - \gamma} \left(e^{-\gamma \tau} - e^{-\sigma \tau}\right),
\end{equation}
where $1/\sigma$ and $1/\gamma$ are mean latent and infectious periods, respectively.
Assuming a constant per-pair contact rate of $\lambda$ for any pair, we obtain the following egocentric generation-interval distribution:
\begin{equation}
\hat{g}(\tau) = \frac{\sigma (\gamma + \lambda)}{\sigma - (\gamma + \lambda)} \left(e^{-(\gamma + \lambda)\tau} - e^{-\sigma \tau}\right)
\end{equation}
In this case, with constant transmission rate during the infection period, the effect of accounting for pairwise contacts is the same as an increase in the recovery rate (by the amount of the per-pair contact rate $\lambda$). 
Infecting a susceptible contact is analogous to recovery because the contactee cannot be infected again --- the infector cannot no longer transmit infection even if they are infectious (effectively losing infectiousness).
Therefore, the resulting egocentric generation-interval distribution is equivalent to the intrinsic generation-interval distribution with mean latent period of $1/\sigma$ and mean infectious period of $1/(\gamma + \lambda)$.
In practice, directly using the egocentric distribution to link $r$ and $\Rini$ using the Euler-Lotka equation is unrealistic because it requires that we know the per-pair contact rate. 
Instead, the per-pair contact rate can be inferred from the growth rate $r$, assuming that mean and variance of the degree distribution of a network is known (see \cite{trapman2016inferring} supplementary material section 1.4.2);
we briefly describe this relationship in Section~\ref{egosection}.

This calculation can be validated by simulating stochastic infection processes on a ``star'' network (i.e, a single infected individual at the center connected to multiple susceptible individuals who are not connected with each other).
Simulations (\fref{local}) confirm that in this case the distribution of \emph{contact} times matches the intrinsic generation-interval distribution (left panel), while the distribution of realized generation intervals (i.e., \emph{infection} times) matches the egocentric generation-interval distribution (middle panel).

\begin{figure}[!ht]
\includegraphics[width=\textwidth]{../fig/local_effect.pdf}
\caption{
\textbf{Spatial effects on realized generation intervals.}
Theoretical distributions and means are shown in color (and are the same in each panel, for reference). Simulated distributions and means are shown in black.
(Left) the intrinsic generation-interval distribution corresponds to all contacts by a focal individual, regardless of whether the contact results in infection.
(Middle) the egocentric generation-interval distribution corresponds to the distribution of all infectious contacts by the focal individual with susceptible individuals, in the case where the focal individual is the only possible infector (simulated on a star network).
(Right) realized generation-interval distributions are shorter than egocentric distributions in general, because contacts can be wasted when susceptibles become infected through other routes (simulated on a homogeneous network).
All figures were generated using 5000 stochastic simulations on a network with 5 nodes (1 infector and 4 susceptibles) with Ebola-like parameters \citep{who2014ebola}:
mean latent period $1/\sigma = 11.4 \textrm{ days}$ and mean infectious period $1/\gamma = 5 \textrm{ days}$. 
Per-pair contact rate $\lambda = 0.25 \textrm{ days}^{-1}$ is chosen to be sufficiently high so that the differences between generation-interval distributions are clear.
Each simulation is run until all individuals are either susceptible or have recovered.
}
\label{fig:local}
\end{figure}

The egocentric generation interval (\eref{conditional}) only explains some of the reduction in realized generation intervals that occurs on most networks, however.
Generation intervals are also shortened by indirect connections: a susceptible individual can be infected through another route before the focal individual makes infectious contacts.
Simulations on a small homogeneous network (i.e., complete network) confirm this additional effect (\fref{local}, right panel). 
We can think of simulations on this network as an approximation of (local) infection process in a small household, consisting of 5 individuals;
we expect realistic local network structures (and their effects on the realized generation intervals) to lay between a star network and a complete network.

In general, spatial reduction in the mean realized generation interval can be viewed as an effect of susceptible depletion and can be further classified into three levels: egocentric, local, and global.
Egocentric depletion, as discussed previously, is caused by an infected individual making multiple contacts to the same individual.
Local depletion refers to a depletion of susceptible individuals in a household or neighborhood;
we can think of these structures as small homogeneous networks embedded in a larger population structure (and therefore we can expect similar effects as we see in \fref{local}, right panel).
Both the egocentric and local depletion effects can be observed early in an epidemic, especially in a highly structured population, even if most of the population remains susceptible.
Finally, global depletion refers to overall depletion of susceptibility at the population level, and explains the reduction in realized compared to intrinsic generation intervals that occurs even in a well-mixed population (\fref{censor}). 

\section{Inferring the initial forward generation-interval distribution}

In a large homogeneously mixing population, the initial forward generation-interval distribution is equivalent to the intrinsic distribution and provides the correct link between the exponential growth rate $r$ and the initial reproduction number \Rini (see \eref{forward}).
In a nonhomogeneous population, the initial forward generation-interval distributions are subject to spatial effects and, therefore, are different from the intrinsic distribution;
since spatial effects have the same effect on how the epidemic spreads as they do on realized generation intervals, we expect the initial forward generation-interval distributions, which implicitly account for the spatial structure, to correctly link $r$ and $\Rini$ through the Euler-Lotka equation (\eref{euler}).
Since spatial effects on realized generation intervals are generally expected to be analytically intractable, even in simple networks (e.g., see \cite{tomba2010some} for discussion regarding the realized generation intervals in a household with one infector and two susceptibles), we rely on simulations to validate this prediction.

\begin{figure}[!ht]
\includegraphics[width=\textwidth]{../fig/diagram.pdf}
\caption{
\textbf{A summary of spatiotemporal effects on generation intervals.}
The intrinsic generation-interval distribution describe the expected time distribution of infectious contacts made by a primary case.
The realized (forward) generation-interval distribution describe the time between actual infection events -- egocentric, local, and global depletion of the susceptible pool reduces the mean realized generation intervals.
The aggregated generation-interval distribution reflects the contact-tracing process during an ongoing epidemic and is subject to right truncation bias.
Our goal is to estimate the initial forward generation-interval distribution from the initial aggregated generation-interval distribution, measured during the exponential growth period.
}
\label{fig:diagram}
\end{figure}

When realized generation intervals are aggregated over the course of an epidemic, there will be four effects present in the data (\fref{diagram}): (1) right-truncation effect, (2) egocentric depletion effect, (3) local depletion effect and (4) global depletion effect.
We can correct explicitly for the egocentric effect and, in the case of exponential growth, the right-truncation effect;
these effects shorten the mean realized generation intervals, which in turn will reduce the estimate of the reproductive number \cite{wallinga2007generation, park2019practical}.
While the other two effects are difficult to measure, we can make qualitative predictions about their effects on the realized generation intervals and reproductive numbers: 
both local and global depletion effects also reduce number of infections that occur and shorten generation intervals.
If we can correct for the truncation bias early in an outbreak, during the exponential growth phase, we should be able to infer the initial forward generation-interval distribution, which incorporates egocentric and local spatial effects but not the global effects, from the aggregated distribution.

\begin{figure}[!ht]
\includegraphics[width=\textwidth]{../fig/cmp_reproductive.pdf}
\caption{\textbf{Comparison of estimates of reproductive number based on various methods.}
Using the aggregated generation-interval distributions (based on the first 1000 realized generation intervals) without correcting for right-truncation (labeled as `contact tracing') severely underestimates the reproductive number.
Similarly, using the intrinsic generation-interval distribution overestimates the reproductive number because it fails to account for local spatial effects; the egocentric distribution corrects for this only partially.
Both population-level and individual-level methods provide estimates of reproductive number that are consistent with the empirical estimates, which we define as the average number of secondary cases generated by the first 75 infected individuals, as well as the estimates based on the initial forward generation intervals, which are calculated by applying the Euler-Lotka equation to the realized generation intervals of all infections caused by the first 75 infected individuals.
Boxplots are generated using 100 stochastic simulations of the SEIR model on an empirical network using Ebola-like parameters \citep{who2014ebola}: mean latent period $1/\sigma = 11.4 \textrm{ days}$ and mean infectious period $1/\gamma = 5 \textrm{ days}$. 
Per-pair contact rate $\lambda = 0.08 \textrm{ days}^{-1}$ is chosen to be sufficiently high such that differences are clear.
}
\label{fig:cmp}
\end{figure}

Here, we investigate two methods for correcting for temporal bias in aggregated generation-interval data (see Methods for details).
We refer to the first method as the population-level method as it relies on realized generation intervals aggregated across the entire population.
When an epidemic is growing exponentially, right-truncation causes the aggregated generation interval to be discounted by the exponential growth rate (\eref{exp});
hence, we can ``undo'' the truncation by exponentially weighting the aggregated generation-interval distribution \citep{tomba2010some, nishiura2010time, britton2019estimation}:
\begin{equation}
f_0(\tau) \propto a_0(\tau) \exp(r\tau),
\label{eq:geff}
\end{equation}
where $r$ is the exponential growth rate.

We refer to the second method as the individual-level method because it relies on individual contact information.
We model each infection as a non-homogeneous Poisson process arising from the infector (\eref{nonhomogeneous}); 
incorporating information about time of infection of an infector, time of infection of an infectee, and time since the beginning of an epidemic allows us to explicitly model the truncation process in the realized generation intervals.
For both methods, mean and coefficient of variation (CV) of generation-interval distributions are estimated by maximum likelihood; the inferred generation-interval distribution is then used to estimate the reproductive number $\Rini$ from the observed growth rate $r$ using the Euler-Lotka equation.

To test these methods, we simulate 100 epidemics with Ebola-like parameters on an empirical network \citep{leskovec2016snap}
and compare the estimates of initial reproductive number with empirical reproductive numbers, which we define as the average number of secondary cases generated by the first 75 infected individuals,
as well as the estimates of the initial reproductive number calculated from the initial forward generation intervals, which we define as the generation intervals for all infections caused by the first 75 infected individuals (\fref{cmp}).
For simplicity, we assume that generation intervals are observed without error and assume that there is no under-reporting.
We do not expect under-reporting to affect the inference of generation-interval distributions (Appendix A.3) unless there are systematic biases in the observation process.
On the other hand, it is difficult to measure generation intervals precisely because (1) infection events are often unobserved and (2) there may be multiple potential infectors; these factors can introduce biases to the estimates of the reproductive number \cite{britton2019estimation}.
We do not pursue these directions in this study.

As expected, estimating the reproductive number based on the intrinsic generation-interval distribution overestimates the empirical reproductive number;
estimates based on the egocentric generation-interval distribution (\eref{conditional}) address this problem only partially, as they do not account for indirect (local) spatial effects. 
Direct estimates based on the observed generation intervals from contact tracing severely underestimate the empirical estimates.
While both population- and individual-level corrections provide similar estimates to the empirical estimates as well as the estimates based on the initial forward generation-interval distribution on average,
population-level estimates are more variable as they are more sensitive to outliers in generation intervals and our estimate of the growth rate.
For smaller values of \RR, we expect the differences to become smaller.
In the Appendix, we present the same figure using smaller \RR\ (Appendix A.1) and using Erlang-distributed latent periods (Appendix A.2), which better corresponds to Ebola.
Overall, our qualitative conclusions do not change.

\section{Discussion}

The intrinsic generation-interval distribution, which describes the expected time distribution of infectious contacts, provides a direct link between speed (initial exponential growth rate, $r$) and strength (initial reproductive number, $\Rini$) of an epidemic in a homogeneously mixing population \citep{wallinga2007generation, svensson2007note, svensson2015influence, park2019practical}.
However, realized generation-interval distributions can vary depending on how and when they are measured \citep{nishiura2010time, tomba2010some, champredon2015intrinsic, britton2019estimation};
determining which distribution correctly links $r$ and $\Rini$ can be challenging.
Here, we analyze how realized generation intervals aggregated over the course of an epidemic, possibly through contact tracing, differ from intrinsic generation intervals.
Changes due to right-truncation reflect observation bias, whereas changes due to spatial or network structure reflect the dynamics of the outbreak.
Thus, correcting the aggregated distribution for temporal, but not spatial, effects provides the correct link between $r$ and $\Rini$.

Realized generation intervals that have been aggregated over the course of an epidemic are subject to right-truncation -- it is not possible to trace individuals that have not been infected yet.
The aggregated distributions can be thought of as averages of ``backward'' generation intervals (measured by looking at infectors of a cohort of individuals infected at the same time) \citep{kenah2008generation, nishiura2010time, tomba2010some, champredon2015intrinsic, britton2019estimation}.
During an ongoing outbreak, the aggregated generation-interval distribution will always have a shorter mean than the intrinsic-interval distribution due to right-truncation.
Early in the outbreak, aggregated intervals are expected to match the early-outbreak backward intervals.
Near the end of an outbreak, the effect of right-truncation becomes negligible but the aggregated generation intervals are still shorter on average than intrinsic generation intervals, because of depletion of the susceptible population.

We think of susceptible depletion as operating on three levels: egocentric, local, and global.
Egocentric susceptible depletion refers to the effect of an infected individual making multiple contacts to the same susceptible individual.
Accounting for the egocentric effect allows us to link the results by \cite{trapman2016inferring} to established results based on generation intervals.
Local susceptible depletion refers to the effect of multiple ``linked'' individuals (e.g., in the same household or neighborhood) making infectious contacts to the same susceptible individual.
Global susceptible depletion refers to the decrease in the susceptible proportion of the whole population.

Susceptible depletion happening at all three levels shortens realized generation intervals but acts on different time scales.
Egocentric and local depletion effects are present from the beginning of an epidemic, even when depletion in the global susceptible population is negligible, and can strongly affect the initial spread of an epidemic.
Therefore, we predict the realized generation intervals during an exponential growth phase to contain information about the contact structure, allowing us to estimate the initial forward generation-interval distribution by simply accounting for the right truncation.
Simulation studies confirm our prediction: using the initial forward generation-interval distribution provides the correct link between $r$ and $\Rini$.

We compare two methods for estimating the initial forward generation-interval distribution and assume that the initial forward generation-interval distribution follows a gamma distribution.
The gamma approximation of the generation interval distribution has been widely used due to its simplicity \citep{mcbryde2009early, nishiura2009transmission, roberts2011early, trichereau2012estimation, nishiura2015theoretical};
we previously showed that in many cases a gamma approximation (requiring estimation of only two parameters) can be sufficient to understand the role of generation-interval distributions in linking $r$ and $\Rini$ for Ebola, rabies, and measles \citep{park2019practical}.
However, further investigation of our methods suggests that making a wrong distributional assumption can lead to biased estimates of the mean and CV of a generation-interval distribution (Appendix A.4), even though the estimated gamma distribution may ``look'' indistinguishable from the true shape of the intrinsic generation-interval distribution (derived from the SEIR model).
These results are particularly alarming because it is impossible to know the true shape of the generation-interval distribution for real diseases.
Nonetheless, biases in the parameter estimates of a generation-interval distribution may have opposite effects on the estimate of \Rini (e.g., shorter mean generation interval leads to lower \Ro whereas narrower generation-interval distribution leads to higher \Ro) and, therefore, may have small effects on the overall estimate of $\Rini$ (Appendix A.4).

Generation-interval-based approaches to estimating the reproductive number often assume that an epidemic grows exponentially \citep{wearing2005appropriate, wallinga2007generation, roberts2007model, park2019practical}.
In practice, heterogeneity in population structure can lead to subexponential growth \citep{szendroi2004polynomial, chowell2015western, chowell2016growing, chowell2016characterizing, kiskowski2016modeling, viboud2016generalized};
we therefore expect our simulations on an empirical network to be better characterized by subexponential growth models \citep{viboud2016generalized}.
However, our simulations suggest that the initial exponential growth assumption still provides a viable approach for estimating the reproductive number.

Contact tracing provides an effective way of collecting epidemiological data and controlling an outbreak \citep{clarke1998contact, eames2003contact, donnelly2003epidemiological}.
In particular, using tracing information allows us to infer real-time estimates of the time-varying reproductive number \citep{cauchemez2006estimating, hens2012robust, jewell2012enhancing, soetens2018real}.
Generation-interval distributions, which can be either assumed or estimated, often play a central role in analyzing tracing data.
Our study illustrates that realized generation intervals over the course of an epidemic contain information about the underlying contact structure, which can be implicitly reflected in the estimates of the reproductive number;
this perspective can be particularly useful for characterizing an epidemic because detailed information about the contact structure is often unavailable.

The generation-interval distribution is a key, and often under-appreciated, component of disease modeling and forecasting.
Different definitions, and different measurement approaches, produce different estimates of these distributions.
We have shown that estimates based on aggregated generation intervals (e.g., measured through contact tracing) differ in predictable ways from intrinsic estimates based on underlying measures of infectiousness (e.g., from shedding studies).
These predictable differences can arise from temporal effects, egocentric spatial effects, local spatial (or network) effects and population-level effects.
Correcting aggregated intervals for temporal effects allows us to estimate a spatially informed initial forward distribution, which accurately describes how disease spreads in a population.
Future studies should carefully consider how measurement influences estimated generation-interval distributions, and how these distributions influence the spread of disease.

\section{Methods}

\subsection{Deterministic SEIR model}

To study the effects on right-truncation on the observed generation intervals, we use the deterministic Susceptible-Exposed-Infectious-Recovered (SEIR) model.
The SEIR model describes how disease spreads in a homogeneously mixing population; it assumes that infected individuals become infectious after a latent period.
We use a \seminar\ model, which extends the SEIR model to have multiple equivalent stages in the latent and infectious periods. This gives latent and infectious periods with Erlang distributions (gamma distributions with integer shape parameters, including the exponential distribution), which are often more realistic than the exponentially distributed periods in the standard SEIR model \citep{anderson1980spread, bailey1964some}: 
\begin{equation}
\begin{aligned}
\frac{\mathrm{d}S}{\mathrm{d}t} &= - \beta S \sum_{k=1}^{n_I} I_k\\
\frac{\mathrm{d}E_1}{\mathrm{d}t} &= \beta S \sum_{k=1}^{n_I} I_k - n_E \sigma E_1\\
\frac{\mathrm{d}E_m}{\mathrm{d}t} &= n_E \sigma (E_{m-1} - E_m) && \text{for } m = 2, 3, \dots, n_E\\
\frac{\mathrm{d}I_1}{\mathrm{d}t} &= n_E \sigma E_m - n_I \gamma I_1\\
\frac{\mathrm{d}I_n}{\mathrm{d}t} &= n_I \gamma (I_{n-1} - I_n) && \text{for } n = 2, 3, \dots, n_I\\
\end{aligned}
\end{equation}
where $S$ is the proportion of susceptible individuals, $E_m$ is the proportion of exposed individuals in the $m$-th compartment, $I_n$ is the proportion of infectious individuals in the $n$-th compartment, and $R$ is the proportion of recovered individuals.
Parameters of the model are specified as follows:  $\beta$ is the transmission rate, $1/\sigma$ is the mean latent period, $n_E$ is the number of latent compartments, $1/\gamma$ is the mean infectious period, and $n_I$ is the number of infectious compartments.
We scale the proportions of individuals in each compartment are scaled by the total population size $N$.
In the main text, we present results based on exponentially distributed latent and infectious periods;
we show results based on more Erlang distributed latent periods ($n_E=2$), which better matches the incubation period distribution of Ebola virus disease, in Appendix.

\subsection{Stochastic SEIR model}

We simulate an individual-based SEIR model on a contact network, using an algorithm based on the ``Gillespie algorithm'' \cite{bartlett1953stochastic,gillespie1977exact}.
We begin by randomly selecting individuals assumed to be infected at $t = 0$.
For each infected individual $i$, we randomly draw the latent period $E_i$ from an Erlang distribution with mean $1/\sigma$ and shape $n_E$.
We then construct the random infectious period and infectious contact times simultaneously as follows.
For each of the $n_I$ stages of the infectious period, we draw the number of effective contacts (before transitioning to the next compartment) from a geometric distribution with probability $n_I\gamma/(S_i \lambda + n_I \gamma)$, where $S_i$ is the number of susceptible acquaintances and $\lambda$ is the per-pair contact rate.
We then choose the time between consecutive events (the chosen number of contacts, followed by exit from the given stage of infection) from an exponential distribution with rate $S_i \lambda + n_I\gamma$.
For each contact, a contactee is uniformly sampled from the set of susceptible acquaintances of the individual $i$.
The infectious period $I_i$ is the sum of all of these waiting times.

After repeating the contact process for all initially infected individuals, all contacts are put into a sorted queue.
The first person in the queue becomes infected (thus decreasing $S_i$ by 1 for all individuals $i$ that are acquaintances of the newly infected individual), and the current time is updated to infection time of this individual. 
Any subsequent contacts made to this individual are removed from the queue because they will no longer be effective.
We repeat the contact process for this newly infected individual.
Then, new contacts are added to the sorted queue.
The simulation continues until there are no more contacts are left in the queue.

\subsection{Egocentric relationship between $r$ and $\RR$ (SEIR model)}
\label{egosection}

Here, we show that the egocentric relationship between $r$ and $\RR$ derived by Trapman \textit{et al.} \cite{trapman2016inferring} (see the original source for detailed derivations) matches what would be calculated by applying the Euler-Lotka equation to the egocentric (rather than the intrinsic) generation-interval distribution. 
Assume that latent and infectious periods are exponentially distributed with mean $1/\sigma$ and $1/\gamma$, respectively.
Assuming a constant per-pair contact rate of $\lambda$ for any pair, the egocentric generation-interval distribution can be written:
\begin{equation}
\hat{g}(\tau) = \frac{\sigma (\gamma + \lambda)}{\sigma - (\gamma + \lambda)} \left(e^{-(\gamma + \lambda)\tau} - e^{-\sigma \tau}\right).
\end{equation}
Substituting into \eref{egorR}, we get
\begin{equation}
\Rego = \left(1 + \frac{r}{\sigma}\right) \left(1 + \frac{r}{\gamma + \lambda}\right),
\end{equation}
where $r$ is the exponential growth rate.
Alternatively, the reproductive number can be expressed based on the degree distribution (mean $\mu$ and variance $v$) of a network:
\begin{equation}
\Rego = \underbrace{\kappa \lambda}_{\text{average contact rate}} \times \underbrace{\frac{1}{\gamma + \lambda}}_{\text{mean effective infectious period}},
\end{equation}
where $\kappa = v/\mu + \mu - 1$, referred to as the mean degree excess \citep{newman2003structure}, describes the expected number of susceptible individuals that an average infected individual will encounter early in an outbreak.
Combining the two equations, we get
\begin{equation}
\lambda = \frac{(\gamma + r) (\sigma + r)}{(\kappa - 1) \sigma - r},
\end{equation}
which completes the relationship between the growth rate and the egocentric reproductive number \citep{trapman2016inferring}:
\begin{equation}
\Rego = \frac{\gamma + r}{\gamma \sigma/(\sigma + r) + r/\kappa}.
\end{equation}

\subsection{Estimating the initial forward generation-interval distribution}

The \textbf{population-level method} estimates the initial forward generation-interval distribution by reversing the inverse exponential weighting in the aggregated generation-interval distribution without explicitly accounting for the infection process (i.e., who infected whom) \citep{tomba2010some, nishiura2010time, britton2019estimation}:
\begin{equation}
f_0(\tau) \propto a_0(\tau) \exp(r\tau),
\end{equation}
where $r$ is the initial exponential growth rate.
In order to do so, we first approximate the aggregated distribution $a_0$ with a gamma distribution by assuming that realized generation intervals (subject to right-truncation) during the exponential growth phase come from the same gamma distribution;
specifically, we estimate the mean $\bar G$ and shape $\alpha$ of a gamma distribution by maximum likelihood.
Then, the initial forward generation-interval distribution also follows a gamma distribution with mean $\alpha/(\alpha/\bar G - r)$ and shape $\alpha$.
We then use the estimated initial forward generation-interval distribution to infer the initial reproductive number $\Rini$ from the estimated growth rate (using the Euler-Lotka equation).

The \textbf{individual-level method} models each infection $i$ from an infected individual $j$ as a non-homogeneous Poisson process between the time at which infector $j$ was infected ($t_j$) and the truncation time ($\tsub{t}{truncate}$), with time-varying Poisson rate at time $t$ is equal to $\Lambda f_0(t - t_j)$, where $f_0(t)$ is the initial forward generation-interval distribution \citep{daley2007introduction}.
We use a gamma distribution (parameterized by its mean and shape) to model the initial forward generation-interval distribution.
Then, the probability that an individual $j$ infects $n_j$ individuals between $t_j$ and $\tsub{t}{truncate}$ is equal to:
\begin{equation}
\frac{\Lambda^{n_j} F_0(\tsub{t}{truncate} - t_j ;\theta)^{n_j} \exp \big(- \Lambda\, F_0(\tsub{t}{truncate} - t_j ;\theta) \big)}{n_j!},
\label{eq:nPoisson}
\end{equation}
where $\theta$ is a (vector) parameter of the initial forward generation-interval distribution $f_0$ (and the corresponding cumulative distribution function $F_0$).
On the other hand, the probability density that the realized generation-interval between infector $j$ and infectee $i$ is equal to $0 \leq s_{i,j} \leq \tsub{t}{truncate} - t_j$ can be expressed using a truncated distribution \citep{lagakos1988nonparametric, kalbfleisch1991regression}:
\begin{equation}
\frac{f_0(s_{i, j}; \theta)}{F_0(\tsub{t}{truncate} - t_j ;\theta)}.
\label{eq:truncdist}
\end{equation}
Therefore, the probability density that individual $j$ infects $n_j$ individuals between $t_j$ and $\tsub{t}{truncate}$ with realized generation intervals $s_{i,j}$ for $i=1,\dots,n_j$ is a product of \eref{nPoisson} and \eref{truncdist}:
\begin{equation}
\frac{\Lambda^{n_j} \exp \big(- \Lambda\, F_0(\tsub{t}{truncate} - t_j ;\theta) \big) \prod_{i=1}^{n_j} f_0(s_{i, j}; \theta)}{n_j!}.
\end{equation}

The full likelihood of contact tracing data, which include aggregated generation intervals as well as information about who infected whom, until time $\tsub{t}{truncate}$ can be written as:
\begin{equation}\label{eq:nonhomogeneous}
\begin{aligned}
&\mathcal{L}(\Lambda, \theta\,|\, \mathbf{s}, \mathbf{t}, \mathbf{n}, \tsub{t}{truncate})\\
&\quad=\prod_{j=1}^N \left(\frac{\Lambda^{n_j} \exp \big(- \Lambda\, F_0(\tsub{t}{truncate} - t_j ;\theta) \big) \prod_{i=1}^{n_j} f_0(s_{i, j}; \theta)}{n_j!} \right),
\end{aligned}
\end{equation}
where $N$ is the total number of infected individuals.
This likelihood is a special case of the likelihood suggested in \citep{kalbfleisch1989inference} which assumes that the second event (observation of infection) occurs simultaneously with the corresponding initiating event (infection of an individual).
Here, we estimate parameters $\Lambda$ and $\theta$ by maximum likelihood.
We then use the estimated distribution $f_0$ to infer the initial reproductive number $\Rini$ from the estimated growth rate (using the Euler-Lotka equation).
When the entire transmission process is known, we expect $\Lambda$ to match $\Rini$;
otherwise, $\Lambda$ will be sensitive to under-reporting of number of infections caused by each infected individual.
As we show in Appendix A.3, the estimates of $\Rini$ using the Euler-Lotka equation from $f_0$ remains unbiased even in the presence of under-reporting.

\subsection{Measuring the exponential growth rate}

We estimate the initial exponential growth rate $r$ of an epidemic from daily incidence by modeling the cumulative incidence $c(t)$ with a logistic function \citep{ma2014estimating}:
\begin{equation}
c(t) = \frac{K}{1 + \left[(K/c_0)-1\right]e^{-rt}}.
\end{equation}
While the exponential growth rate (i.e., the rate of change in log incidence) of the logistic function changes throughout an epidemic,
we focus strictly on estimating the \emph{initial} exponential growth rate (when $t \to -\infty$).
The method of estimating the initial exponential growth rate by fitting a logistic curve has been previously validated against simulations of stochastic compartmental models \citep{ma2014estimating}.

Fitting directly to cumulative incidence can lead to overly confident results \citep{king2015avoidable}; instead we fit interval incidence $x(t) = c(t + \Delta t) - c(t)$, where $\Delta t$ is 1 day, to daily incidence, assuming that daily incidence follows a negative binomial distribution with overdispersion parameter $\theta$.
We estimate parameters $r$, $K$, $c_0$, and $\theta$ by maximum likelihood.
Fitting time window is defined from the last trough before the peak of an epidemic to the first day after the peak of an epidemic.

\subsection{Empirical network}

To simulate epidemics on a realistic network, we use the `condensed matter physics' network from the Stanford Large Network Dataset Collection \citep{leskovec2016snap}.
This graph describes co-authorship among anyone who submitted a paper to Condensed Matter category in the arXiv between January 1993 and April 2003 \citep{leskovec2007graph}.
It consists of 23133 nodes and 93497 edges.
The same network was used by \cite{trapman2016inferring} to study how network structure affects the estimate of the reproductive number.

\section*{Authors' contributions}

SWP led the literature review, performed analytic calculations and simulations, and wrote the first draft of the MS; JD conceived the study, performed analytic calculations and wrote the first draft of the MS; all authors contributed to refining study design, literature review, and final MS writing. All authors gave final approval for publication. 

\section*{Competing interests}

The authors declare that they have no competing interests.

\section*{Funding}

This work was supported by the Canadian Institutes of Health Research [funding reference number 143486].

\pagebreak

\bibliography{networkprsb}
\end{document}
